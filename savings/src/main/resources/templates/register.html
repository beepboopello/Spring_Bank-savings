<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <title>Đăng ký</title>
</head>
<style>
    .error_msg {
        color: red;
    }

    .error_div {
        margin-top: 5px;
    }
</style>
<script>
    function register() {
        let data = {
            firstName: document.getElementById("id_fistName").value,
            lastName: document.getElementById("id_lastName").value,
            email: document.getElementById("id_email").value,
            username: document.getElementById("id_username").value,
            password: document.getElementById("id_password").value
        };
        fetch("/api/register", {
            method: "POST",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        }).then(r => r.json().then(data => ({ status: r.status, body: data })))
            .then(obj => {
                const arrayError = ["id_err-firstName", "id_err-lastName", "id_err-email", "id_err-username", "id_err-password"];
                for (const id of arrayError) {
                    document.getElementById(id).innerHTML = "";
                }
                if(!obj.body.error){
                    location.href = '/';
                }
                console.log(obj.body.error); 
                for(var error in obj.body.error){
                    document.getElementById("id_err-"+error).innerHTML = obj.body.error[error]
                    console.log("id_err-"+error + " " + obj.body.error[error])
                }
            });

    }
</script>

<body>
    <div class="container" style="margin-top: 50px;">
        <div class="row"
            style="border: 1px darkgrey solid; border-radius: 10px;width: 50%; margin: 0 auto; padding: 20px;">
            <div class="col-sm-12">
                <h3>Nhập thông tin nhân viên mới để truy cập hệ thống</h3>
                <!-- <form action="login" method="post"> -->

                <div class="form-group">
                    <label>Tên</label>
                    <input id="id_fistName" type="text" class="form-control" name="username"
                        placeholder="Nhập tên">
                    <div class="error_div">
                        <i class="error_msg" id="id_err-firstName"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label>Họ + tên đệm</label>
                    <input id="id_lastName" type="text" class="form-control" name="username"
                        placeholder="Nhập họ và tên đệm">
                    <div class="error_div">
                        <i class="error_msg" id="id_err-lastName"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input id="id_email" type="text" class="form-control" name="password" placeholder="Nhập email">
                    <div class="error_div">
                        <i class="error_msg" id="id_err-email"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label>Tài khoản</label>
                    <input id="id_username" type="text" class="form-control" name="otp" placeholder="Nhập tài khoản">
                    <div class="error_div">
                        <i class="error_msg" id="id_err-username"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label>Mật khẩu</label>
                    <input id="id_password" type="password" class="form-control" name="otp" placeholder="Nhập mật khẩu">
                    <div class="error_div">
                        <i class="error_msg" id="id_err-password"></i>
                    </div>
                </div>

                <p style="color: red" th:text="${error}"></p>
                <button id="id_btn_register" onclick="register()" class="btn btn-primary">Đăng ký</button>
                <button id="id_btn_verify" onclick="verify()" style="display: none" class="btn btn-primary">Xác
                    nhận</button>
                <!-- </form> -->
            </div>
        </div>
    </div>
</body>

</html>